/* === BORDER === */

/* === OUTER BROWSER BORDER FIX === */
/* Force zero border-radius on all possible browser container elements */
:root,
#main-window,
#navigator-toolbox,
#titlebar,
#TabsToolbar,
.browserContainer,
#appcontent,
#browser,
.browserSidebarContainer,
#zen-tabbox-wrapper,
#zen-appcontent-wrapper,
body,
body > hbox,
#zen-main-app {
    border-radius: 0px;
    border-radius: 0;
}

/* Specifically target the outermost window elements */
window,
#main-window,
:root[sizemode="normal"],
:root[sizemode="maximized"] {
    border-radius: 0px !important;
    border-radius: 0 !important;
}

/* Ensure the main browser area has sharp corners */
#browser {
    border-radius: 0px !important;
    -moz-appearance: none !important;
    appearance: none !important;
    overflow: clip !important;
    padding: 0px !important;
}

body > hbox {
    border-radius: 0px !important;
    /* background: var(--na-color-bg) !important; */
}

/* window border on maximize */
:root[sizemode="maximized"] #browser::before {
    content: "";
    position: absolute;
    inset: 0;
    border: 2px solid var(--na-color-border);
    pointer-events: none;
    z-index: 9999;
}

/* window border on minimize */
:root[sizemode="normal"] #browser::before {
    content: "";
    position: absolute;
    inset: 0;
    border: 2px solid var(--na-color-border);
    border-radius: var(--na-window-border-radius);
    pointer-events: none;
    z-index: 9999;
}

/* Tahoe shiny border */
/* #zen-browser-background {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  border-radius: inherit;
  z-index: 9999;
  border: 1px solid rgba(255, 255, 255, 0.25);
  box-shadow:
    inset 0 1px 2px rgba(255, 255, 255, 0.15),
    inset 0 -1px 2px rgba(0, 0, 0, 0.25),
    0 0 0 1px rgba(0, 0, 0, 0.25),
    0 4px 12px rgba(0, 0, 0, 0.3);
  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0.08),
    rgba(255, 255, 255, 0.02)
  );
} */

:root[sizemode="fullscreen"] #browser::before {
    border: 0 !important;
    border-radius: 0px !important;
    outline: none !important;
    outline-offset: 0px !important;
}

:root[inDOMFullscreen="true"] #browser::before {
    border: 0 !important;
    border-radius: 0px !important;
    outline: none !important;
    outline-offset: 0px !important;
}

/* Ensure all browser elements have squared corners */
:root #browser,
:root body * {
    border-radius: 0;
}

:root[sizemode="normal"] #zen-browser-background {
    border-radius: var(--na-window-border-radius) !important;
}

/* window border on spit tabs */
:root:has(#tabbrowser-tabpanels [zen-split]) .deck-selected {
    border-radius: 0px !important;
    border: 2px solid var(--na-color-border) !important;
}

:root:has(#tabbrowser-tabpanels [zen-split]) .browserSidebarContainer {
    border-radius: 0px !important;
}

/* content window border radius */


:root:has([zen-compact-mode="true"]):has([zen-single-toolbar="true"]):not(
        [inDOMFullscreen="true"]
    )
    .browserSidebarContainer {
    border-radius: var(--na-window-border-radius) !important;
}

:root:not([sizemode="normal"]) .browserSidebarContainer {
    border-radius: 0 !important;
}

/* content window border size on RIGHT side tabbar */
:root[zen-right-side="true"]:not([zen-compact-mode="true"]):not(
        [inDOMFullscreen="true"]
    )
    #zen-tabbox-wrapper {
    border: 2px solid var(--na-color-border) !important;
}

/* content window border size on LEFT side tabbar */
:root:not([zen-right-side="true"]):not([zen-compact-mode="true"]):not(
        [inDOMFullscreen="true"]
    )
    #zen-tabbox-wrapper {
    border: 2px solid var(--na-color-border) !important;
}

/* remove content window border on split tabs*/
:root:has(#tabbrowser-tabpanels [zen-split]) #zen-tabbox-wrapper {
    border: none !important;
}

/* content window bottom margin on SINGLE-TOOLBAR mode */
/* @media (-moz-bool-pref: "zen.view.use-single-toolbar") {
  :root[zen-sidebar-expanded="true"]:not([zen-compact-mode="true"]):not([inDOMFullscreen="true"]) #zen-tabbox-wrapper {
    margin-bottom: var(--na-window-margin) !important;
  }
} */

/* @media (-moz-pref("zen.view.use-single-toolbar")) {
  @media not (-moz-bool-pref: "wireframe.urlbar.position.top"){
    :root[zen-sidebar-expanded="true"]:not([zen-compact-mode="true"]):not([inDOMFullscreen="true"]) #zen-tabbox-wrapper {
      margin-bottom: calc( var(--na-window-margin) - 10px ) !important;
    }
  }
} */

/* content window + address bar */
#zen-appcontent-wrapper {
    /* background-color: var(--na-color-bg) !important; */
    border-radius: 0px !important;
    /*! margin: 0px !important; */
    padding: 0px !important;
    overflow: hidden !important;
}

/* window */
#zen-tabbox-wrapper {
    box-shadow: none !important;
    overflow: clip !important;
    padding: 0px !important;
    /*! background-color: var(--na-color-bg) !important; */
    overflow: hidden !important;
    padding: 0px !important;
    background-clip: padding-box !important;
}

/* WEBVIEW BORDER RADIUS */

#tabbrowser-tabbox,
#tabbrowser-tabbox > * {
    margin: 0 !important;
    padding: 0 !important;
    box-sizing: border-box !important;
}

:root[zen-right-side="true"]:not([zen-compact-mode="true"]):not(
        [inDOMFullscreen="true"]
    )
    #zen-tabbox-wrapper {
    border-radius: var(--na-user-border-radius) !important;
}

:root:not([zen-right-side="true"]):not([zen-compact-mode="true"]):not(
        [inDOMFullscreen="true"]
    )
    #zen-tabbox-wrapper {
    border-radius: var(--na-user-border-radius) !important;
}

/* ADD WEBVIEW BORDER RADIUS TO CHILDREN ELEMENTS OF TABBOX */
:root:not([zen-compact-mode="true"]) {
    @media not (-moz-pref("wireframe.nogaps.enabled")) {
        #tabbrowser-tabpanels {
            border-radius: var(--na-user-border-radius) !important;
        }

        #tabbrowser-tabpanels > * {
            border-radius: inherit !important;
            transition: border-radius 0.18s linear !important;
        }
    }
}

:root:has([zen-compact-mode="true"]):has([sizemode="normal"])
    ):has(#zen-appcontent-navbar-wrapper[zen-has-hover="false"]) {
    #zen-tabbox-wrapper {
        border-radius: var(--na-window-border-radius) !important;
    }

    #tabbrowser-tabbox,
    #tabbrowser-tabbox > * {
        border-radius: var(--na-window-border-radius) !important;
    }
}

:root[inDOMFullscreen="true"] {
    #tabbrowser-tabpanels {
        border-radius: 0 !important;
    }
}

/* SPLIT TABS */
@media (-moz-pref("zen.view.use-single-toolbar")) {
    :root:has(
            #tabbrowser-tabpanels [zen-split]
        )[zen-compact-mode="true"][zen-sidebar-expanded="true"]
        #zen-tabbox-wrapper {
        margin: var(--na-window-margin) !important;
    }

    :root:has(#tabbrowser-tabpanels [zen-split])[zen-compact-mode="true"]:not(
            [zen-sidebar-expanded="true"]
        )
        #zen-tabbox-wrapper {
        margin-inline: var(--na-window-margin) !important;
        margin-top: var(--na-window-margin) !important;
        margin-bottom: 0px !important;
    }
}

/* NO GAPS COMPACT MODE (DEFAULT) */

:root[zen-single-toolbar="true"][zen-compact-mode="true"]:not([customizing]) {
    /* Credits to CompTechGuy */
    #zen-appcontent-navbar-wrapper {
        min-height: 0.1px !important;
        height: 0.1px !important;
    }

    #zen-appcontent-navbar-wrapper[zen-has-hover="true"] {
        height: 34px !important;
    }

    --zen-element-separation: 0px !important;

    #zen-tabbox-wrapper,
    #tabbrowser-tabbox,
    #tabbrowser-tabbox > * {
        border-radius: var(--na-window-border-radius) !important;
    }
}

/* FIX : REMOVE NAVBAR CONTAINER WHEN EMPTY */
:root[zen-single-toolbar="true"][zen-compact-mode="true"]:not(
        [customizing]
    ):has(#PersonalToolbar[collapsed]) {
    @media (-moz-pref("zen.view.experimental-force-window-controls-left")) {
        #zen-appcontent-navbar-wrapper {
            display: none !important;
        }
    }
}

:root:not([zen-single-toolbar="true"])[zen-compact-mode="true"]:not(
        [customizing]
    ) {
    /* Credits to CompTechGuy */

    /* TODO: ADD HIDE PREF FOR MULTI TOOLBAR TOPBAR !!! */

    /*   #zen-appcontent-navbar-wrapper {
	  min-height: 0.1px !important;
		height: 0.1px !important;
    transition: 0.18s ease !important;
	}

	#zen-appcontent-navbar-wrapper[zen-has-hover="true"] {
	  height: 34px !important;
	} */

    --zen-element-separation: 0px !important;

    @media not (-moz-pref("wireframe.urlbar.position.top")) {
        #zen-tabbox-wrapper,
        #tabbrowser-tabbox,
        #tabbrowser-tabbox > *,
        .browserSidebarContainer,
        .browserSidebarContainer > * {
            border-bottom-left-radius: 0 !important;
            border-bottom-right-radius: 0 !important;
        }
    }

    @media (-moz-pref("wireframe.urlbar.position.top")) {
        #zen-tabbox-wrapper,
        #tabbrowser-tabbox,
        #tabbrowser-tabbox > *,
        .browserSidebarContainer,
        .browserSidebarContainer > * {
            border-top-left-radius: 0 !important;
            border-top-right-radius: 0 !important;
        }
    }
}

:root:not([zen-single-toolbar="true"])[zen-compact-mode="true"][sizemode="normal"] #browser,
:root:not([zen-single-toolbar="true"])[zen-compact-mode="true"][sizemode="normal"] #main-window{
  overflow: hidden !important;
  clip-path: inset(0 round var(--na-window-border-radius));
}

/* fix for corner bleeding in single toolbar compact mode */
:root[zen-single-toolbar="true"][zen-compact-mode="true"] #browser,
:root[zen-single-toolbar="true"][zen-compact-mode="true"] #main-window {
    overflow: hidden !important;
    clip-path: inset(0 round var(--na-window-border-radius));
}

/* BORDER FOR MULTI TOOLBAR TOP BAR */
:root:not([zen-single-toolbar="true"])[zen-compact-mode="true"] {
    @media not (-moz-pref("wireframe.urlbar.position.top")) {
        #zen-appcontent-navbar-wrapper {
            border-top: 2px solid var(--na-color-border) !important;
        }
    }

    @media (-moz-pref("wireframe.urlbar.position.top")) {
        #zen-appcontent-navbar-wrapper {
            border-bottom: 2px solid var(--na-color-border) !important;
        }
    }
}

/* === Webview Border Radius Pref === */
@media (-moz-pref("wireframe.webview.border_radius", 0)) {
    :root {
        --na-user-border-radius: 0px;
    }
}

@media (-moz-pref("wireframe.webview.border_radius", 4)) {
    :root {
        --na-user-border-radius: 4px;
    }
}

@media (-moz-pref("wireframe.webview.border_radius", 8)) {
    :root {
        --na-user-border-radius: 8px;
    }
}

@media (-moz-pref("wireframe.webview.border_radius", 12)) {
    :root {
        --na-user-border-radius: 12px;
    }
}

@media (-moz-pref("wireframe.webview.border_radius", 16)) {
    :root {
        --na-user-border-radius: 16px;
    }
}

@media (-moz-pref("wireframe.webview.border_radius", 20)) {
    :root {
        --na-user-border-radius: 20px;
    }
}

/* === Window border radius pref === */
@media (-moz-pref("wireframe.window.border_radius", 0)) {
    :root {
        --na-window-border-radius: 0px;
    }
}

@media (-moz-pref("wireframe.window.border_radius", 4)) {
    :root {
        --na-window-border-radius: 4px;
    }
}

@media (-moz-pref("wireframe.window.border_radius", 8)) {
    :root {
        --na-window-border-radius: 8px;
    }
}

@media (-moz-pref("wireframe.window.border_radius", 12)) {
    :root {
        --na-window-border-radius: 12px;
    }
}

@media (-moz-pref("wireframe.window.border_radius", 16)) {
    :root {
        --na-window-border-radius: 16px;
    }
}

@media (-moz-pref("wireframe.window.border_radius", 20)) {
    :root {
        --na-window-border-radius: 20px;
    }
}

@media (-moz-pref("wireframe.window.border_radius", 24)) {
    :root {
        --na-window-border-radius: 24px;
    }
}

/* === NO GAPS === */

@media (-moz-pref("zen.view.use-single-toolbar")) {
    @media (-moz-pref("wireframe.nogaps.enabled")) {
        :root {
            --zen-element-separation: 0px !important;
        }

        :root:not([zen-right-side="true"]):not([zen-compact-mode="true"]):not(
                [inDOMFullscreen="true"]
            )
            #zen-tabbox-wrapper {
            margin: 0 !important;
            border-radius: var(--na-window-border-radius) !important;
            border: none !important;
        }

        :root:not([zen-right-side="false"]):not([zen-compact-mode="true"]):not(
                [inDOMFullscreen="true"]
            )
            #zen-tabbox-wrapper {
            margin: 0 !important;
            border-radius: var(--na-window-border-radius) !important;
            border: none !important;
        }

        /* sidebar on the RIGHT → kill right corners */
        :root[zen-right-side="true"]:not([zen-compact-mode="true"]):not(
                [inDOMFullscreen="true"]
            )
            #zen-tabbox-wrapper {
            border-top-right-radius: 0 !important;
            border-bottom-right-radius: 0 !important;
        }

        /* sidebar on the LEFT → kill left corners */
        :root:not([zen-right-side="true"]):not([zen-compact-mode="true"]):not(
                [inDOMFullscreen="true"]
            )
            #zen-tabbox-wrapper {
            border-top-left-radius: 0 !important;
            border-bottom-left-radius: 0 !important;
        }

        /*     :root[zen-single-toolbar="true"]:not([customizing]) {
      & #zen-appcontent-navbar-wrapper {
        margin-block: -10px !important;
      }
    } */
    }
}

/* fix for transparent blank page */
.browserStack {
    browser {
        background-color: transparent !important;
    }
}
